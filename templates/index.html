<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TREVINO WAR ROOM</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div id="job-list-pane">
        <div id="header-stats">
            <div class="stat-block">
                <span style="color:var(--green)">SESSION:</span>
                <span class="stat-item">IN:<span id="s_scraped" class="stat-val-s">0</span></span>
                <span class="stat-item">OK:<span id="s_approved" class="stat-val-s">0</span></span>
                <span class="stat-item">NO:<span id="s_denied" class="stat-val-s">0</span></span>
            </div>
            <div class="stat-block" style="border-left:1px solid #333; padding-left:15px;">
                <span style="color:var(--blue)">TOTAL:</span>
                <span class="stat-item">IN:<span id="a_scraped" class="stat-val-a">0</span></span>
                <span class="stat-item">OK:<span id="a_approved" class="stat-val-a">0</span></span>
                <span class="stat-item">NO:<span id="a_denied" class="stat-val-a">0</span></span>
            </div>
            <button class="btn-import" onclick="openImportModal()">+ IMPORT</button>
        </div>
        
        <div id="tabs">
            <div class="tab active" onclick="switchTab('NEW')">INCOMING</div>
            <div class="tab" onclick="switchTab('REFINERY')">REFINERY</div>
            <div class="tab" onclick="switchTab('FACTORY')">FACTORY</div>
            <div class="tab" onclick="switchTab('DELIVERED')">ARMORY</div>
            <div class="tab" onclick="switchTab('DENIED')">GRAVEYARD</div>
        </div>
        <div class="grid-header" id="grid-header"></div>
        <div id="list-container"></div>
    </div>
    
    <div id="detail-pane">
        <!-- VIEW 1: STANDARD (INCOMING) -->
        <div id="standard-view">
            <div id="std-skills-box">
                <div class="tag-section-title">DETECTED SIGNALS</div>
                <div id="std-tags"></div>
            </div>
            <div id="std-desc-box">Select a target...</div>
        </div>

        <!-- VIEW 2: REFINERY (SORTING) -->
        <div id="refinery-view">
            <div id="unsorted-box">
                <div class="col-header" style="color:var(--gold); text-align:left;">UNSORTED SIGNALS (TAB to Select)</div>
                <div id="refinery-new-tags"></div>
            </div>
            <div id="arsenal-box">
                <div class="arsenal-cols">
                    <div class="arsenal-col" id="col-q"><div class="col-header">QUALIFICATIONS</div></div>
                    <div class="arsenal-col" id="col-s"><div class="col-header">SKILLS</div></div>
                    <div class="arsenal-col" id="col-b" style="border:none;"><div class="col-header">BENEFITS</div></div>
                </div>
            </div>
        </div>

        <!-- VIEW 3: INCINERATOR (GRAVEYARD) -->
        <div id="incinerator-view">
            <div id="debris-box">
                <div class="tag-section-title" style="color:var(--red)">TARGETING COMPUTER (TAB TO SELECT)</div>
                <div id="incinerator-stage"></div>
            </div>
            <div id="furnace-box">
                <div class="col-header" style="color:var(--red)">DISPOSAL CONTROLS</div>
                <p>SELECT A CHIP ABOVE...</p>
                <ul style="line-height:2; list-style:none; padding:0;">
                    <li><span style="color:var(--gold)">[C]</span> BAN COMPANY</li>
                    <li><span style="color:var(--blue)">[T]</span> BAN TITLE</li>
                    <li><span style="color:#888">[K]</span> BAN KEYWORD</li>
                </ul>
            </div>
        </div>

        <!-- VIEW 4: FACTORY (AI) WITH CONFIG ACCORDION -->
        <div id="factory-view">
            <div id="factory-config">
                <div id="config-header" onclick="toggleFactoryConfig()">
                    <span style="color:var(--gold)">[ MISSION PARAMETERS ]</span>
                    <span id="config-toggle-icon">+</span>
                </div>
                <div id="config-body" style="display:none;">
                    <label>PERSONA LOADOUT:</label>
                    <select id="persona-select" onchange="loadPersona()"></select>
                    
                    <label>SYSTEM PROMPT (IDENTITY):</label>
                    <textarea id="sys-prompt-area" rows="10"></textarea>
                    
                    <div style="display:flex; gap:10px; margin-top:10px;">
                        <div style="flex:1">
                            <label>TEMPERATURE:</label>
                            <input type="number" id="model-temp" step="0.1" min="0" max="1" value="0.6">
                        </div>
                        <div style="flex:1">
                            <label>MODEL:</label>
                            <select id="model-select">
                                <option value="llama-3.3-70b-versatile">Llama 3.3 70B</option>
                                <option value="mixtral-8x7b-32768">Mixtral 8x7B</option>
                                <option value="gemma-7b-it">Gemma 7B</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div id="factory-desc">Job Description...</div>
            <div id="factory-terminal">
                > SYSTEM READY.
                > SELECT A TARGET.
                > CONFIGURE MISSION PARAMETERS.
            </div>
        </div>

        <!-- VIEW 5: ARMORY (PDF) -->
        <div id="product-view">
            <div id="product-header">
                <span style="color:var(--green); font-weight:bold;">TAILORED RESUME JSON</span>
                <button class="btn-pdf" id="btn-open-pdf" onclick="openPDF()">OPEN PDF</button>
            </div>
            <div id="resume-content">Loading Resume Data...</div>
        </div>

        <div id="controls">
            <button class="btn-deny" id="btn-d" onclick="action('deny')">DENY (D)</button>
            <button class="btn-approve" id="btn-a" onclick="action('approve')">APPROVE (A)</button>
            
            <button class="btn-process" id="btn-p" onclick="action('process')">EXECUTE (1)</button>
            <button class="btn-process" id="btn-psel" onclick="processSelected()">EXECUTE (SEL)</button>
            <button class="btn-process" id="btn-pall" onclick="processAll()">EXECUTE (ALL)</button>
            
            <button class="btn-restore" id="btn-r" onclick="action('restore')">RESTORE</button>
        </div>
    </div>

    <!-- MODAL -->
    <div id="import-modal">
        <div class="modal-content">
            <h3 style="color:var(--green); margin-top:0;">SELECT INTEL FILES</h3>
            <div class="file-list" id="modal-file-list"></div>
            <div style="display:flex; justify-content:space-between;">
                <button style="display:inline-block; border-color:#555;" onclick="document.getElementById('import-modal').style.display='none'">CANCEL</button>
                <button style="display:inline-block; background:var(--green); border-color:var(--green); color:black;" onclick="executeMigration()">MIGRATE SELECTED</button>
            </div>
        </div>
    </div>
    <script src="/static/js/main.js"></script>
</body>
</html>
